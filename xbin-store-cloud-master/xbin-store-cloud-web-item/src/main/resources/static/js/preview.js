/*!Name: preview.js
 * Date: 2017-2-14 17:14:17 */
define("MOD_ROOT/js/preview",function(require,exports,module){function e(e){function t(t){var o=t.find("img"),l=o.attr("src"),d=o.attr("data-url"),h=o.attr("data-iframe"),m=a.index(t);if(c!=m){if(c=m,h){var p,f;e.twoColumn?p=f=s.wideVersion?450:300:e.ctCloth?s.wideVersion?(p=350,f=449):(p=300,f=384):p=f=s.wideVersion?350:300;var w=h+"&width="+p+"&height="+f;$("#spec-n1").removeClass("jqzoom").html('<iframe src="'+w+'" scrolling="no" frameborder="0" width="'+p+'" height="'+f+'" allowfullscreen="true"></iframe>')}else{$("#spec-n1").addClass("jqzoom").html(n),0==m?$(".p-watermark").show():$(".p-watermark").hide(),l=l.replace(/54x54/g,"450x450"),l=l.replace(/50x64/g,"350x449"),l=l.replace(/\/n5/g,"/n1");var u="";u=e.ctCloth?l.replace(/350x449/g,"800x1026"):i+r+d,$("#spec-n1 img").eq(0).attr({src:l,jqimg:u}).show()}a.removeClass("img-hover"),t.addClass("img-hover")}}var i=pageConfig.FN_GetImageDomain(e.skuid),o=/isOverseaPurchase-2/.test(e.specialAttrs),r=o?"/popWaterMark/":"/n0/",a=$("#spec-list li"),n=$("#spec-n1").html(),c=-1;e.ctCloth&&$("body").addClass("ctCloth"),a.mouseenter(function(){t($(this))}),t(a.eq(0));var l=$(".jqzoom");if(l.find("img").attr("src")){var d=540,h=540;l.jqueryzoom({xzoom:d,yzoom:h,offset:10,position:"left",lens:1})}var m=s.wideVersion?5:3;$(".spec-items").imgScroll({width:$(".spec-items li").eq(0).outerWidth(!0),visible:m,showControl:!0,step:m,loop:!1,prev:"#spec-forward",next:"#spec-backward"});var p=$("#spec-n1");"1"===p.attr("data-big")&&p.bind("click",function(t){var i=$(t.target);!i.is("#three-d-show")&&i.parents("#three-d-show").length<1&&window.open("//item.jd.com/bigimage.aspx?id="+e.skuid)})}function t(e){var t=$(".J-follow");a.init(t),a.check&&a.check([e.skuid],function(e,i){i&&t.addClass("followed").find("em").text("\u5df2\u5173\u6ce8")})}function i(e){function t(t){var i=$("#preview .spec-items li img"),o=[],r=$(".J-share");i.each(function(){var e=$(this).attr("src");o.push(e)});var a="\u6211\u5728@\u4eac\u4e1c \u53d1\u73b0\u4e86\u4e00\u4e2a\u975e\u5e38\u4e0d\u9519\u7684\u5546\u54c1\uff1a "+e.name+"\u3000\u4eac\u4e1c\u4ef7\uff1a\uffe5 {PRICE}\u3002 \u611f\u89c9\u4e0d\u9519\uff0c\u5206\u4eab\u4e00\u4e0b";new t({sid:3,rid:986951,$el:r,title:a,content:a,url:location.href,imgs:o,onbeforeOpen:function(t){t.jp=e.jp}}).popUp()}var i=$(".J-share");i.bind("click",function(){require.async("MOD_ROOT/preview/combineShare",t)})}function o(e){function t(){$("body").dialog({width:940,height:500,title:"3D \u5c55\u793a",type:"iframe",source:r})}var i=$("#three-d-show"),o=$("#spec-n1");if(!$("#three-d-show").length)return!1;var r=i.attr("data-href");o.delegate("#three-d-show","click",t)}function r(r){o(r),e(r),t(r),i(r),n.init(null,null,"gbk")}var a=require("JDF_UNIT/js/follow"),n=require("MOD_ROOT/js/contrast"),s=require("MOD_ROOT/js/core");require("JDF_UI/js/dialog"),require("MOD_ROOT/js/abtest"),require("MOD_ROOT/js/tools");require("MOD_ROOT/css/contrast.css"),require("PLG_ROOT/js/jQuery.imgScroll"),require("PLG_ROOT/js/jQuery.zoom"),module.exports.__id="preview",module.exports.init=r});