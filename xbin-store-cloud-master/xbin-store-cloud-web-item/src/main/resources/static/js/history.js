/* toolbar-1.0.0 history.js Date:2016-11-17 18:06:40 */
define("TB_ROOT/js/history",function(require,a,b){"use strict";var c=require("JDF_UNIT/js/globalReco.js");var d=require("TB_ROOT/js/tools.js");var e=function(a){this.name="history",this._toolbar=window.pageConfig.toolbar.settings,this.container=a.$content,this.init()};e.prototype={init:function(){this.render(),this.hover()},render:function(){var a=this;var b=$('<div class="jt-history-wrap"></div>');var e=[];var f='<ul>{for item in data}<li class="jth-item"><a href="//item.jd.com/${item.sku}.html" clstag="'+this._toolbar.clsPageType+"|keycount|cebianlan_"+this._toolbar.clsPageType+"_"+this.name+'|item" class="img-wrap" target="_blank" title="${item.t}"><img src="${pageConfig.FN_GetImageDomain(item.sku)}n0/s100x100_${item.img}" width="100" height="100"/></a><a class="add-cart-button" clstag="'+this._toolbar.clsPageType+"|keycount|cebianlan_"+this._toolbar.clsPageType+"_"+this.name+'|addtocart" href="//gate.jd.com/InitCart.aspx?pid=${item.sku}&pcount=1&ptype=1" target="_blank">\u52a0\u5165\u8d2d\u7269\u8f66</a><a href="//item.jd.com/${item.sku}.html" target="_blank" class="price J-p-${item.sku}"></a></li>{/for}</ul><a href="//my.jd.com/history/list.html" clstag="'+this._toolbar.clsPageType+"|keycount|cebianlan_"+this._toolbar.clsPageType+"_"+this.name+'|more_history" class="history-bottom-more" target="_blank">\u67e5\u770b\u66f4\u591a\u8db3\u8ff9\u5546\u54c1 >></a>';new c({$el:b,template:f,skuHooks:"SKUS_recent_view",param:{p:202001,sku:"",ck:"pin,ipLocation,atw,aview",lim:50},callback:function(c,f){if(c){for(var g in f.data)f.data.hasOwnProperty(g)&&e.push(f.data[g].sku);d.priceNum({skus:e,$el:a.container,callback:function(b,c){-1===parseInt(c.p,10)&&a.container.find(".J-p-"+b).siblings(".add-cart-button").remove()}}),a.container.html(b)}else window.pageConfig.toolbar.setStatus(a.container,'\u8fd8\u6ca1\u6709\u6d4f\u89c8\u5386\u53f2\u54e6~~<br><a href="//www.jd.com/">\u53bb\u9996\u9875\u770b\u770b</a>')}})},hover:function(){this.container.delegate(".jth-item","mouseenter",function(){$(this).addClass("jth-item-hover")}),this.container.delegate(".jth-item","mouseleave",function(){$(this).removeClass("jth-item-hover")})}},b.exports=e});
