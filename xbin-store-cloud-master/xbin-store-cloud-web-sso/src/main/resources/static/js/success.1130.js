/* user-reg/1.0.0 success.1130.js Date:2016-12-08 17:48:03 */
define("user/reg/1.0.0/js/success.1130.js",["jdf/1.0.0/ui/placeholder/1.0.0/placeholder.js","user/reg/1.0.0/js/validation.1130.js","user/reg/1.0.0/js/suggest.1130.js","user/reg/1.0.0/js/dialog.1130.js"],function(require,a){require("jdf/1.0.0/ui/placeholder/1.0.0/placeholder.js"),require("user/reg/1.0.0/js/validation.1130.js"),require("user/reg/1.0.0/js/suggest.1130.js"),require("user/reg/1.0.0/js/dialog.1130.js");var c=$("#form-email");var d=$("#emailForm");var e={def:'<i class="i-def"></i>',error:'<i class="i-error"></i>',success:'<i class="i-suc"></i>'};function f(){k(),l(),i(),g()}function g(){document.domain="jd.com",$("#showIframe").bind("click",function(){$("#showIframe").dialog({title:"\u5b9e\u540d\u8ba4\u8bc1\u540e\u5373\u988650\u5143\u793c\u5305",type:"iframe",autoIframe:!0,width:738,height:440,source:"//credit.jd.com/xbCredit/showCoupon",onReady:function(){document.domain="jd.com",$("#dialogIframe").load(function(){document.domain="jd.com";var a;var b=$(".ui-dialog");try{$("#dialogIframe").contents()&&(a=$("#dialogIframe").contents())}catch(c){return}a.find(".coupon-list-wrap").length>0?(a.find(".coupon-wrap").show(),$(".ui-dialog,.ui-dialog-title,.ui-dialog-content").css("width",a.find(".coupon-wrap").width()),$(a.find(".view-btn a")).unbind().bind("click",function(){a.find(".coupon-wrap").hide(),$(".ui-dialog,.ui-dialog-title,.ui-dialog-content").css("width","888px"),b.css("left",($(window).width()-b.width())/2),b.css("top",($(window).height()-b.height())/2)})):a.find(".xb-s-wrap").length>0&&($(".ui-dialog,.ui-dialog-title,.ui-dialog-content").css("width",a.find(".xb-s-wrap").width()),b.css("left",($(window).width()-b.width())/2),b.css("top",($(window).height()-b.height())/2),$(a.find(".view-btn a")).unbind().bind("click",function(){var b=a.find(".view-btn a").attr("href");var c=window.open();return $(".ui-dialog-close").trigger("click"),setTimeout(function(){c.location=b},1),$(".info-con .con").remove(),$(".info-con .tit").css("line-height","70px"),!1})),$("#dialogIframe").css("height","440px")})}})})}var h;function i(){h=d.validate({submitHandler:function(){return j(),!1},onkeyup:!1,rules:{email:{required:!0,email:!0}},messages:{email:{required:e.error+"\u8bf7\u586b\u5199\u90ae\u7bb1",email:e.error+"\u683c\u5f0f\u9519\u8bef"}}})}function j(){var a=d.serialize();$.ajax({url:"../notify/email",cache:!1,data:a,dataType:"json",success:function(a){var b=c[0];var d=!1,f={};if(1==a.success){d=!0;var g=o(b.value);var i=e.success+"\u9a8c\u8bc1\u5df2\u53d1\u9001\u90ae\u7bb1"+c.val();""!=g&&(i+='<a href="'+g+'" target="_blank">\u67e5\u770b\u90ae\u7bb1</a>'),c.parent().next().find("span").html(i)}return 0==a.success&&(f[b.name]=e.error+"\u8be5\u90ae\u7bb1\u5df2\u88ab\u4f7f\u7528\uff0c\u8bf7\u66f4\u6362\u5176\u5b83\u90ae\u7bb1"),-1==a.success&&(f[b.name]=e.error+"\u7cfb\u7edf\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5 \uff01"),-2==a.success&&(f[b.name]=e.error+"\u60a8\u7533\u8bf7\u53d1\u9001\u9a8c\u8bc1\u90ae\u4ef6\u7684\u6b21\u6570\u8d85\u9650\uff0c\u8bf7\u4e8e24\u5c0f\u65f6\u540e\u91cd\u8bd5\uff01"),-3==a.success?void(window.location.href="http://reg.jd.com/reg/expire"):(-4==a.success&&(f[b.name]=e.error+"\u8be5\u8d26\u53f7\u5df2\u9a8c\u8bc1\u8fc7\u90ae\u7bb1"),-5==a.success&&(f[b.name]=e.error+"\u8bf7\u8f93\u5165\u6709\u6548\u7684\u90ae\u7bb1\u5730\u5740"),void(d||(c.parent().next().find("span").show(),h.showErrors(f))))},error:function(){p("\u670d\u52a1\u5668\u7f13\u5fd9\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5!")}})}function k(){$("input[placeholder]").placeholder({isValue:!0,topDiff:1})}function l(){var a=["@qq.com","@163.com","@126.com","@Sina.com","@Sohu.com","@Gmail.com"];c.suggest({type:"email",items:a,customerClass:"email-suggest",onshow:function(){m(c)}})}function m(a,b){var c=a.parent();var b=a.attr("default");c.removeClass("form-item-error form-item-valid"),c.next().find("span").removeClass("error").html(b).show()}var n=["http://gmail.google.com/","http://mail.163.com/","http://mail.126.com/","http://www.hotmail.com/","http://mail.sina.com/","http://mail.sina.com/","http://mail.tom.com/","http://mail.qq.com/","http://mail.10086.cn/","https://login.live.com/login.srf","http://mail.sohu.com/"];function o(a){var b=a.indexOf("@");var c=a.substring(b+1,a.length).toLowerCase();var d="";return"gmail.com"==c?d="http://gmail.google.com/":$.each(n,function(a){n[a].indexOf(c)>-1&&(d=n[a])}),d}function p(a){$("body").dialog({title:"\u63d0\u793a",fixed:!0,width:280,maskClose:!0,type:"html",source:'<div class="registerDialog">                        <div class="ico"></div>                        <div class="con">                        '+a+"                        </div></div>"})}a.init=f});