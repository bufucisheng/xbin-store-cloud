define("home/widget/head_areamini",function(require,exports,module){"use strict";!function(e,t){function n(e){return(e||"").replace(/(^\s*)|(\s*$)/g,"")}function i(e){var t=arguments;if(t.length>1){for(var a=0,c=t.length;a<c;a++)if(i(t[a]))return!0;return!1}return"undefined"===String(e)||"null"===String(e)||"string"==typeof e&&""===n(e)}function a(e,t){var n={provinceId:0,provinceName:"",cityId:0,cityName:"",districtId:0,districtName:"",townId:0,townName:""},i=e.split("-");0==i[0]&&(i=L);var a=o(i[0]).value;n.provinceId=a.id,n.provinceName=a.name,t(n)}function c(){var t=[];return w.provinceList&&w.provinceList.length>0?t=w.provinceList:(e.each(w.province,function(e,n){t.push({id:e.replace("_",""),name:n})}),w.provinceList=t),t}function o(e){var t={id:e,name:""},n=0,i=w.province["_"+e];return i||(i=w.province["_"+L[0]],n=1,t.id=L[0]),t.name=i,{value:t,isDefault:n}}function s(e,t){var n=e.initArea||S(e.cookieMapping.allLocal)||e.defaultArea||k;i(e.initArea)&&e.syncServer?_.sync(function(e){var i=e&&e.adds||n;a(i||n,t)}):a(n,t)}function l(e){return e&&[{id:e.provinceId,name:e.provinceName},{id:e.cityId,name:e.cityName},{id:e.districtId,name:e.districtName},{id:e.townId,name:e.townName}]||[]}function r(t,n,a){e.each(l(t),function(e,t){i(t.id)||0==t.id||(n.push(t.id),a.push(t.name))})}function d(t,n,i,a){var c="";if(n.name.length>=i.longerAreaSize?c="longer-area":n.name.length>=i.longAreaSize&&(c="long-area"),a&&i.className.selected||c){var o=e(t);a&&i.className.selected&&o.find("a:first").addClass(i.className.selected),c&&o.addClass(c),t=e("<div/>").html(o).html(),t=t.replace(/&lt;/g,"<").replace(/&gt;/g,">")}return n.tpl?e.tpl(n.tpl,n):e.tpl(t,n)}function u(t,n,i,a){var o=this,s=o.options.provinceList,l=[],r=[];return r=s?s:c(),e.each(r,function(e,t){l.push(d(n,t,o.options,t.id==a.provinceId))}),e.tpl(t,{list:l.join(""),index:i})}function p(){var t=this,n=t.el,i=t.options,c=i.className;e("."+c.content_content,n).undelegate("a[data-id]","click").delegate("a[data-id]","click",function(o){o.preventDefault();var s=e(this),l={id:s.data("id"),name:s.html()},r=C(n,l.id,0);i.className.selected&&e("."+c.content_content+" a."+i.className.selected,n).removeClass(i.className.selected),a(r,function(n){i.className.selected&&s.addClass(i.className.selected),i.selectedClose&&m.call(t,!1),x.call(t,n),e.isFunction(i.onChange)&&i.onChange.call(t,s,l,n),i.writeCookie&&v(i,n.provinceId,r),i.syncServer&&i.writeServer&&f(r,n.provinceId)})}),e("."+c.content_content,n).undelegate("a[data-onchange=1]","click").delegate("a[data-onchange=1]","click",function(){var a=e(this);i.className.selected&&(e("."+c.content_content+" a."+i.className.selected,n).removeClass(i.className.selected),a.addClass(i.className.selected)),i.selectedClose&&m.call(t,!1),e.isFunction(i.onChange)&&i.onChange.call(t,a)})}function v(e,t,n){S(e.cookieMapping.areaId,t,e.cookieOpts),S(e.cookieMapping.allLocal,n,e.cookieOpts)}function f(e,t){_.sync(e,t)}function m(e){var t=this,n=t.options.className.hover;e?(j>-1&&(clearTimeout(j),j=-1),h.call(t),t.el.addClass(n),j=setTimeout(function(){t.el.addClass(n)},1)):(j>-1&&(clearTimeout(j),j=-1),t.el.removeClass(n))}function h(){var t=this,n=t.el,i=e(t.css.content),a=e(t.css.text).width(),c=i.width(),o=e(I).width(),s=n.offset().left,l=e(t.css.text).offset().left;if(i.data("left")?i.css("left",i.data("left")):i.data("left",i.css("left")),s+c>o){var r=c-a-10;r>l&&(r-=r-l+a-20),i.css({left:"-"+r+"px"})}else s<parseInt(i.css("left"))*-1&&i.css({left:"0px"})}function g(e){return e?[e.provinceId,e.cityId,e.districtId,e.townId]:[0,0,0,0]}function C(e,t,n){var i=e.data("select-local");return i=i&&i.split("-")||[0,0,0,0],"object"==typeof t?i=g(t):(i=w.city[t],i&&(i=(i+"-0").split("-"))),i=i.join("-"),e.data("select-local",i),i}function N(t,n){var i=this,a=i.el,c=i.options,o=c.tplContentWrap,s=c.tplContentItem;e(i.css.content_content).html(u.call(i,o,s,0,t)),n==-1&&C(a,t),p.call(i,c)}function x(t){var n=this,i=[],a=[];r(t,a,i),a=a.join("-"),i=i.join(""),e(n.css.text_text).html(i).attr("data-id",a).attr("title",i)}function y(t,n){var i={};return e.each(n,function(a,c){var o=a.split("_"),s=[],l=o.length;e.each(o,function(e,t){if(s.push("."+n[t]),l>1&&2+e==l)return s.push("."+c),!1}),i[a]=t+" "+s.join(" ")}),i}var I=window,L=[1,72,0,0],k=L.join("-"),j=-1,w={province:{"北京":1,"上海":2,"天津":3,"重庆":4,"河北":5,"山西":6,"河南":7,"辽宁":8,"吉林":9,"黑龙江":10,"内蒙古":11,"江苏":12,"山东":13,"安徽":14,"浙江":15,"福建":16,"湖北":17,"湖南":18,"广东":19,"广西":20,"江西":21,"四川":22,"海南":23,"贵州":24,"云南":25,"西藏":26,"陕西":27,"甘肃":28,"青海":29,"宁夏":30,"新疆":31,"港澳":52993,"台湾":32,"钓鱼岛":84},city:{1:"1-72-2799",2:"2-2813-51976",3:"3-51035-39620",4:"4-113-9775",5:"5-142-143",6:"6-303-304",7:"7-412-415",8:"8-560-567",9:"9-639-640",10:"10-727-728",11:"11-799-801",12:"12-904-905",13:"13-2900-2908",14:"14-1151-1153",15:"15-1158-1224",16:"16-1303-1305",17:"17-1432-1435",18:"18-1482-1485",19:"19-1601-3633",20:"20-3168-3169",21:"21-1827-1828",22:"22-2103-2105",23:"23-3690-3693",24:"24-2144-2145",25:"25-4108-6823",26:"26-3970-3972",27:"27-2428-2429",28:"28-2525-2526",29:"29-2580-2581",30:"30-2628-2629",31:"31-4110-4122",52993:"52993-52994-52996",32:"32-2768-2769",84:"84-1310-0"},area:{},serverLocal:null,provinceList:null};w.province=function(){var t={};return e.each(w.province,function(e,n){t["_"+n]=e}),t}();var _={getUrl:"//uprofile.jd.com/u/getadds?callback=?",setUrl:"//uprofile.jd.com/u/setadds",sync:function(t,n){var i="jd.com"==document.domain;if(e.isFunction(t)){if(w.serverLocal)return w.serverLocal;i?t({addr:S("ipLoc-djd")}):e.getJSON(this.getUrl,function(e){w.serverLocal=e,t(e)})}else if(i){var a={domain:".jd.com",path:"/",expires:10};S("areaId",n,a),S("ipLoc-djd",t,a)}else w.serverLocal={adds:t},e.ajax({url:this.setUrl,type:"get",dataType:"jsonp",data:w.serverLocal})}},S=function(e,t,n){if("undefined"==typeof t){var i=null;if(document.cookie&&""!=document.cookie)for(var a=document.cookie.split(";"),c=0;c<a.length;c++){var o=jQuery.trim(a[c]).split("=");if(o[0]==e&&o.length>1){try{i=decodeURIComponent(o[1])}catch(s){i=o[1]}break}}return i}n=n||{},null===t&&(t="",n.expires=-1);var l="";if(n.expires&&("number"==typeof n.expires||n.expires.toUTCString)){var r;"number"==typeof n.expires?(r=new Date,r.setTime(r.getTime()+24*n.expires*60*60*1e3)):r=n.expires,l="; expires="+r.toUTCString()}var d=n.path?"; path="+n.path:"",u=n.domain?"; domain="+n.domain:"",p=n.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(t),l,d,u,p].join("")};e.ui.define("areamini",{options:{hasCssLink:!0,baseVersion:"1.0.0",cssLinkVersion:"1.0.0",syncServer:!1,initArea:null,defaultArea:null,provinceList:null,provinceExtend:!0,longAreaSize:4,longerAreaSize:12,cookieMapping:{areaId:"areaId",allLocal:"ipLoc-djd"},writeCookie:!0,cookieOpts:{expires:null,path:null,domain:null,secure:null},writeServer:!0,className:{hover:"ui-areamini-hover",text:"ui-areamini-text-wrap",text_text:"ui-areamini-text",content:"ui-areamini-content-wrap",close:"ui-areamini-close",content_tab:"ui-areamini-tab",content_content:"ui-areamini-content",content_content_list:"ui-areamini-content-list",selected:""},tplContentWrap:'<ul class="ui-areamini-content-list"><%=list%></ul>',tplContentItem:'<li><a data-id="<%=id%>" href="javascript:void(0)"><%=name%></a></li>',event:"hover",onReady:null,onChange:null,selectedClose:!0},css:{},init:function(){var t=this,n=t.options,i=t.el;n.scopeLevel=1,t.css=y("#"+i[0].id,n.className),n.provinceList&&n.provinceExtend&&(n.provinceList=e.extend(!0,[],c().concat(n.provinceList))),s(n,function(a){x.call(t,a),N.call(t,a,-1);var c="hover"==n.event?"mouseenter":"click";e(t.css.text).bind(c,function(){return m.call(t,!0),!1}),e(i).bind("mouseleave",function(e){m.call(t,!1)}),e(t.css.close).bind("click",function(){m.call(t,!1)}),e.isFunction(n.onReady)&&n.onReady.call(t,a)})},hide:function(){var e=this,t=e.options.className.hover;e.el.removeClass(t)},show:function(){var e=this,t=e.options.className.hover;e.el.addClass(t)}})}(jQuery)});