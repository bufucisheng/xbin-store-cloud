/* virtuals-squares/1.0/ game.js Date:2016-12-22 16:47:40 */
define("virtuals/squares/1.0/js/game.js",["virtuals/popui/1.0.0/js/lang/date.js","virtuals/popui/1.0.0/js/lang/object.js","virtuals/popui/1.0.0/js/lang/string.js","//storage.jd.com/card/html/jdIndex_gameQqStandard.js","//misc.360buyimg.com/virtuals/squares/1.0/js/ui/popui-tab.js","//misc.360buyimg.com/virtuals/squares/1.0/js/ui/popui-setCursorPosition.js","//misc.360buyimg.com/virtuals/squares/1.0/js/ui/popui-placeholder.js","//misc.360buyimg.com/virtuals/squares/1.0/js/ui/popui-cityLayer.js","//misc.360buyimg.com/virtuals/squares/1.0/js/ui/popui-suggest.js","//misc.360buyimg.com/virtuals/squares/1.0/js/ui/popui-citySuggest.js","//misc.360buyimg.com/virtuals/squares/1.0/js/game-squares.js"],function(require,a,b){require("virtuals/popui/1.0.0/js/lang/date.js");require("virtuals/popui/1.0.0/js/lang/object.js");require("virtuals/popui/1.0.0/js/lang/string.js");var e=require("//storage.jd.com/card/html/jdIndex_gameQqStandard.js");require("//misc.360buyimg.com/virtuals/squares/1.0/js/ui/popui-tab.js"),require("//misc.360buyimg.com/virtuals/squares/1.0/js/ui/popui-setCursorPosition.js"),require("//misc.360buyimg.com/virtuals/squares/1.0/js/ui/popui-placeholder.js"),require("//misc.360buyimg.com/virtuals/squares/1.0/js/ui/popui-cityLayer.js"),require("//misc.360buyimg.com/virtuals/squares/1.0/js/ui/popui-suggest.js"),require("//misc.360buyimg.com/virtuals/squares/1.0/js/ui/popui-citySuggest.js");var f=require("//misc.360buyimg.com/virtuals/squares/1.0/js/game-squares.js");var g=decodeURIComponent(e.gameStr);var h=decodeURIComponent(e.qqStr);var i=e.gameBrandStr;var j=e.dataJson;$.fn.popuigetPopUI=function(a){return this.data(a)},$.fn.popuisuggest.except={"\u4e2d\u6587/\u62fc\u97f3":1};var k=function(){var a=[];var b=g.split("^^");return $.each(b,function(b,c){var d={};var e=c.split("|");d.gameName=e[0],d.isHot="black"===e[1]?!1:!0,d.price=e[2],d.gameWord=e[0].split("-")[0],1!==d.gameWord.length&&(d.gameWord=""),a.push(d)}),a}();var l=function(){var a=[];var b=h.split("^^");return $.each(b,function(b,c){var d={};var e=c.split("|");d.gameName=e[0],d.isHot="black"===e[1]?!1:!0,d.price=e[2],d.gameWord=e[0].split("-")[0],1!==d.gameWord.length&&(d.gameWord=""),a.push(d)}),a}();var m=function(){var a=[];return $.each(k,function(b,c){var d=[];d[0]=c.gameWord,d[1]=function(){return 2===c.gameName.split("-").length?c.gameName.split("-")[1]:c.gameName}(),d[2]=c.gameWord,d[3]=c.gameWord,a.push(d)}),a}();var n=function(){var a=[];return $.each(l,function(b,c){var d=[];d[0]=c.gameWord,d[1]=function(){return 2===c.gameName.split("-").length?c.gameName.split("-")[1]:c.gameName}(),d[2]=c.gameWord,d[3]=c.gameWord,a.push(d)}),a}();var o=function(){var a={};var b=["HOT","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];return $.each(b,function(b,c){a[c]=[],"HOT"===c?$.each(k,function(b,d){if(d.isHot){var e=function(){return 2===d.gameName.split("-").length?d.gameName.split("-")[1]:d.gameName}();a[c].push([d.gameWord,e,d.gameWord,d.gameWord])}}):$.each(k,function(b,d){if(d.gameWord===c){var e=function(){return 2===d.gameName.split("-").length?d.gameName.split("-")[1]:d.gameName}();a[c].push([d.gameWord,e,d.gameWord,d.gameWord])}})}),$.each(b,function(b,c){0===a[c].length&&delete a[c]}),a}();[].slice;var q={};q.init=function(a){try{a.el.html(f)}catch(b){}var c=$("#squares-game");var d=c.find(".jp-tab");var e=c.find(".tab-content");var g=c.find(".jp-content");function h(a){var b=g.eq(0).outerWidth();var c=b*a;e.stop().animate({marginLeft:-c},300),d.removeClass("current").eq(a).addClass("current"),p()}function p(){$(".squares-game-calendar,.squares-game-layer,.squares-game-suggest,.squares-qq-layer").hide()}d.bind("mouseover",function(a){a.preventDefault();var b=$(this).index();h(b)});try{var s=c.find(".jp-content-gn").find(".start-city");s.popuicityLayer({left:-172,title:"\u652f\u6301\u6c49\u5b57/\u9996\u5b57\u6bcd\u8f93\u5165",tab:["\u70ed\u95e8","ABCDEFG","HIJKLMN","OPQRSTU","WXYZ"],layerCls:"squares-game-layer squares-game-pop",data:o});var t=s.popuigetPopUI("cityLayer");t.bind("choose",function(a,b){s.css("color","#666"),K(b.name)}),s.click(function(){setTimeout(function(){$(".squares-game-layer,.squares-qq-layer").find(".mc1").find("[data-ui='tab-content']").each(function(){$(this).find(".clr").eq(-1).css("border","0")})},500)});var u;var v;t.hover(function(){clearTimeout(u)},function(){v=setTimeout(function(){t.hide()},200)}),s.parent().bind("mouseleave",function(){clearTimeout(u),u=setTimeout(function(){t.hide()},200)}).bind("mouseenter",function(){clearTimeout(v)}),s.popuicitySuggest({wrapCls:"ac_results sug_results squares-game-suggest squares-game-pop",dataArr:m,fixScroll:"hide",showPinyin:!1}).bind("blur",function(){var a=$(this);var b=a.val();$(".squares-game-suggest:visible");""==b&&(a.val(""),a.attr("data-val","")),$(".squares-game-suggest").is(":visible")&&(M(b,1)?a.attr("data-val",M(b,1)):(a.val(""),a.attr("data-val","")))}).bind("keyup",function(){""==$(this).val()&&$(this).trigger("click")}).bind("focus click",function(){$(this).select(),$(".squares-game-suggest").html("")});var y=s.popuigetPopUI("suggest");y.bind("choose",function(a,b){s.css("color","#666"),K(b)});var z=c.find(".jp-content-gn").find(".start-date");A();function A(){0===$(".squares-game-money").length&&$("body").append('<div class="squares-game-money squares-game-pop" style="display: none;"></div>')}z.click(function(){if(""!==s.val()&&s.val()!==s.attr("placeholder")){var a=$(this).offset().left-39;var b=$(this).offset().top;var c=$(".squares-game-money");c.css({left:a,top:b+25}).show()}}),$(".squares-game-money").click(function(){}).delegate("li","click",function(){z.val($(this).find("a").html()).css("color","#666"),$(".squares-game-money").hide();var a=$.trim(s.val());var b=J(a);var d=$.trim(z.val());var e=b[d];B(e,c.find(".jp-content-gn")),C(c.find(".jp-content-gn"))}),c.delegate("#squares-search-game","click",function(){if($(this).hasClass("squares-disabled"))return!1;if(""===c.find(".jp-content-gn .start-city").val()||"\u6e38\u620f"===c.find(".jp-content-gn .start-city").val())return alert("\u8bf7\u5148\u9009\u62e9\u6e38\u620f"),!1;var a="//card.jd.com/order/order_place.action?dianka=4&skuId=";var b=C(c.find(".jp-content-gn")).skuid;window.open(a+b)});function B(a,b){var c=b.find(".game-method-zc,.game-method-km");c.hide(),$.each(a,function(a,b){"zc"===b&&c.filter(".game-method-zc").show(),"km"===b&&c.filter(".game-method-km").show()}),c.filter(":visible").eq(0).find("input").prop("checked",!0)}function C(a){var b=a.find(".start-city").val();var c=function(){var a="";return $.each(i,function(c,d){var e=d.aliasName.split("-");var f=e[e.length-1];f===b&&(a=d.brandId)}),a}();var d=function(){return a.find(".game-method-zc,.game-method-km").find(":checked").val()}();var e=function(){return a.find(".start-date").val().replace("\u5143","")}();var f=String(c)+"_"+String(d)+"_"+String(e);var g=E();var h=function(){var a={};return $.each(j,function(b,d){d.brandId===c&&$.each(d.list,function(b,c){c.skuType===f&&$.each(c.list,function(b,c){c.s===g&&(a=c)})})}),a}();if("v"in h){var k=h.v;var l=h.p;return a.find(".game-money-result").html(l),a.find(".search-jp-btn").removeClass("squares-disabled").html("\u5feb\u901f\u5145\u503c"),{gameName:b,brandId:c,cztype:d,mz:e,timeSign:g,skutype:f,skuid:k,price:l}}D(a)}function D(a){a.find(".search-jp-btn").addClass("squares-disabled").html("\u7f3a\u8d27")}function E(){var a=new Date(pageConfig.timestamp);var b=a.getHours()+",";var c="A";return"1,2,3,4,5,6,7,8,9,".indexOf(b)>-1?"E":"18,19,20,".indexOf(b)>-1?"A":"14,15,16,17,".indexOf(b)>-1?"B":"10,11,12,13,".indexOf(b)>-1?"C":"21,22,23,0,".indexOf(b)>-1?"D":c}c.find(".jp-content-gn").find(".game-method-zc,.game-method-km").click(function(){C(c.find(".jp-content-gn"))}),c.find(".jp-content-gj").find(".game-method-zc,.game-method-km").click(function(){C(c.find(".jp-content-gj"))});var F;var G;$(".squares-game-money").hover(function(){clearTimeout(F)},function(){G=setTimeout(function(){$(".squares-game-money").hide()},200)}),z.parent().bind("mouseleave",function(){clearTimeout(F),F=setTimeout(function(){$(".squares-game-money").hide()},200)}).bind("mouseenter",function(){clearTimeout(G)});function J(a){var b=function(){var b={};return $.each(k,function(c,d){var e=function(){return 2===d.gameName.split("-").length?d.gameName.split("-")[1]:d.gameName}();return e===a?(b=d,!1):void 0}),b.price}();return L(b)}function K(a){var b=J(a);var c='<ul class="clearfix">';for(var d in b)c+='<li><a href="javascript:void(0);">'+d+"</a></li>";c+="</ul>",$(".squares-game-money").html(c).find("li").eq(0).trigger("click")}function L(a){if(0===a.length)return{};var b={};return a=a.split(","),a=a.slice(0,-1),$.each(a,function(a,c){var d=c.split("{")[0];var e=function(){var a=[];for(var b=1;b<c.split("{").length;b++)a.push(c.split("{")[b].slice(0,2));return a}();b[d]=e}),b}function M(a,b){var c=null;var d=m;var e=d.length;if(a&&d.length)for(;e--;)if(c=d[e],a==c[1]||a==c[2])return 1==b?c[0]:c[1];return!1}function N(){0===$(".squares-qq-content").length&&$("body").append('<div class="squares-qq-content squares-game-pop" style="display: none;"></div>')}function O(){0===$(".squares-qq-money").length&&$("body").append('<div class="squares-qq-money squares-game-pop" style="display: none;"></div>')}function P(){var a='<ul class="clearfix">';$.each(n,function(b,c){a+='<li><a href="javascript:void(0);" title="'+c[1]+'">'+c[1]+"</a></li>"}),a+="</ul>",$(".squares-qq-content").html(a)}function Q(a){var b=function(){var b=function(){var b={};return $.each(l,function(c,d){var e=function(){return 2===d.gameName.split("-").length?d.gameName.split("-")[1]:d.gameName}();return e===a?(b=d,!1):void 0}),b.price}();return L(b)}();var c='<ul class="clearfix">';for(var d in b)c+='<li><a href="javascript:void(0);">'+d+"</a></li>";c+="</ul>",$(".squares-qq-money").html(c).find("li").eq(0).trigger("click")}N(),P(),O(),c.find(".jp-content-gj .start-city").click(function(){var a=$(this).offset().left-10;var b=$(this).offset().top;var c=$(".squares-qq-content");c.css({left:a,top:b+25}).show()}),$(".squares-qq-content").click(function(){}).delegate("li","click",function(){var a=$(this).find("a").html();c.find(".jp-content-gj .start-city").val(a).css("color","#666"),$(".squares-qq-content").hide(),Q(a)});var R=null;$(".squares-qq-content").hover(function(){clearTimeout(R)},function(){clearTimeout(R),R=setTimeout(function(){$(".squares-qq-content").hide()},200)}),c.find(".jp-content-gj .start-city").parent().bind("mouseleave",function(){clearTimeout(R),R=setTimeout(function(){$(".squares-qq-content").hide()},200)}).bind("mouseenter",function(){clearTimeout(R)});var S=c.find(".jp-content-gj .start-date");S.click(function(){var a=c.find(".jp-content-gj .start-city");if(""!==a.val()&&a.val()!==a.attr("placeholder")){var b=$(this).offset().left-39;var d=$(this).offset().top;var e=$(".squares-qq-money");e.css({left:b,top:d+25}).show()}}),$(".squares-qq-money").click(function(){}).delegate("li","click",function(){S.val($(this).find("a").html()).css("color","#666"),$(".squares-qq-money").hide();var a=$.trim(c.find(".jp-content-gj .start-city").val());var b=function(){var b=function(){var b={};return $.each(l,function(c,d){var e=function(){return 2===d.gameName.split("-").length?d.gameName.split("-")[1]:d.gameName}();return e===a?(b=d,!1):void 0}),b.price}();return L(b)}();var d=$.trim(S.val());var e=b[d];B(e,c.find(".jp-content-gj")),C(c.find(".jp-content-gj"))});var T=null;$(".squares-qq-money").hover(function(){clearTimeout(T)},function(){clearTimeout(T),T=setTimeout(function(){$(".squares-qq-money").hide()},200)}),c.find(".jp-content-gj .start-date").parent().bind("mouseleave",function(){clearTimeout(T),T=setTimeout(function(){$(".squares-qq-money").hide()},200)}).bind("mouseenter",function(){clearTimeout(T)}),c.delegate("#squares-search-qq","click",function(){if($(this).hasClass("squares-disabled"))return!1;if(""===c.find(".jp-content-gj .start-city").val()||"QQ"===c.find(".jp-content-gj .start-city").val())return alert("\u8bf7\u5148\u9009\u62e9\u5145\u503c\u9879\u76ee"),!1;var a="//card.jd.com/order/order_place.action?dianka=4&skuId=";var b=C(c.find(".jp-content-gj")).skuid;window.open(a+b)}),$(".squares-game-layer .mc1 a").eq(0).trigger("click"),$(".squares-qq-content a").eq(0).trigger("click")}catch(b){}c.find("input[placeholder], textarea").each(function(){var a=navigator.userAgent.indexOf("MSIE 6.0")>0;var b=$(this).attr("placeholder");a?$(this).val("\u9009\u62e9"+b).css("color","#aaa"):$(this).popuiplaceholder({word:b,evtType:"focus",color:"#aaa"})}),c.click(function(){}).find("input,a").keydown(function(a){9==a.which&&a.preventDefault()}),window.SQUARES_GAME={},$.ajax({type:"get",url:"//fa.jd.com/loadFa_toJson.js?aid=0_0_8000-0_0_8001-0_0_8002",dataType:"script",scriptCharset:"GBK",success:function(){var b=$("#squares-game");b.find(".card-word-ad").html(SQUARES_GAME.gnword),b.find(".qq-word-ad").html(SQUARES_GAME.gnword),b.find(".ad-left-img").html(SQUARES_GAME.leftimg),b.find(".ad-right-img").html(SQUARES_GAME.rightimg),b.find(".card-word-ad").find("a").attr("clstag","h|keycount|2016|11d01f"),b.find(".qq-word-ad").find("a").attr("clstag","h|keycount|2016|11d02e")},error:function(){}})},q.popCls=".squares-game-pop",b.exports=q});
